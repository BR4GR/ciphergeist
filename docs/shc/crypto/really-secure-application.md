# Really Secure Encryption

## Description
We recently had an intern around before the crisis happened. He learned about cryptography and encrypted the password for our coffee machine???

We can't get through this without coffee.

Author
Coderion

Public modulus (n): 1186029292037952909983792432306452587425266074685148559256411524118533884795954832993947356308189843827916747393770934033391200656633881903962557992375311329821223845429093776689672634207483637282457856395284891548748666784553146529707500135533133296584880911894111872112018935683414189955943902732488471774953

Public exponent (e): 65537

Encrypted flag: 733568336222790589470096969949196690400886881122508612017162580799729948344126319987475331014669434677564792251353760238087218803592587521385878004071493183548939254573853401155722047457350634791379651022516512709399603944845196902930993851922578027579933013748262257897144604228176365756268938687669643000231
´´´

## Solution

This RSA challenge has a critical weakness: one of the prime factors is extremely small.

**Vulnerability**: The modulus `n` can be factored because it contains the small prime `7`.

**Attack Method**: Query FactorDB.com for known factorizations:

```bash
curl -X GET https://factordb.com/api?query=1186029292037952909983792432306452587425266074685148559256411524118533884795954832993947356308189843827916747393770934033391200656633881903962557992375311329821223845429093776689672634207483637282457856395284891548748666784553146529707500135533133296584880911894111872112018935683414189955943902732488471774953
```

Returns:
```json
{"id":1100000007513254511,"status":"FF","factors":[["7",1],["169432756005421844283398918900921798203609439240735508465201646302647697827993547570563908044027120546845249627681562004770171522376268843423222570339330189974460549347013396669953233458211948183208265199326413078392666683507592361386785733647590470940697273127730267444574133669059169993706271818926924539279",1]]}
```

With `p = 7` and `q = <large_number>`, we can calculate the private key and decrypt the message.

**Decryption Steps**:
1. Calculate `φ(n) = (p-1)(q-1) = 6 × (q-1)`
2. Calculate private key: `d = e^(-1) mod φ(n)`
3. Decrypt: `message = ciphertext^d mod n`
4. Convert to text: `long_to_bytes(message)`


**Flag**: `SCD{w34k_r54_pr1m3s_1fed2fea}`
